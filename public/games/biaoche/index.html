<!doctype html>
<html dir="ltr" lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="initial-scale=1, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0, width=device-width">
<meta name="screen-orientation" content="portrait">
<title>Racing Chase</title>
<style>
body {
    margin: 0;
    padding: 0;
    background: #000;
    font-family: Arial, sans-serif;
    overflow: hidden;
}

#gameContainer {
    position: relative;
    width: 100vw;
    height: 100vh;
    background: linear-gradient(to bottom, #87CEEB 0%, #98FB98 100%);
}

#gameCanvas {
    display: block;
    margin: 0 auto;
    background: #333;
    border: 2px solid #fff;
}

#ui {
    position: absolute;
    top: 20px;
    left: 20px;
    color: white;
    font-size: 24px;
    font-weight: bold;
    text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
}

#instructions {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    color: white;
    text-align: center;
    font-size: 18px;
    background: rgba(0,0,0,0.7);
    padding: 20px;
    border-radius: 10px;
}

#gameOver {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    color: white;
    text-align: center;
    font-size: 24px;
    background: rgba(0,0,0,0.8);
    padding: 30px;
    border-radius: 15px;
    display: none;
}

button {
    background: #ff6b6b;
    color: white;
    border: none;
    padding: 10px 20px;
    font-size: 16px;
    border-radius: 5px;
    cursor: pointer;
    margin: 10px;
}

button:hover {
    background: #ff5252;
}
</style>
</head>
<body>
<div id="gameContainer">
    <canvas id="gameCanvas" width="400" height="600"></canvas>
    
    <div id="ui">
        <div>Score: <span id="score">0</span></div>
        <div>Hearts: <span id="hearts">0</span></div>
    </div>
    
    <div id="instructions">
        <h2>Racing Chase</h2>
        <p>Use mouse or touch to move your car</p>
        <p>Collect hearts (♥) and avoid obstacles</p>
        <p>Click anywhere to start!</p>
    </div>
    
    <div id="gameOver">
        <h2>Game Over!</h2>
        <p>Final Score: <span id="finalScore">0</span></p>
        <p>Hearts Collected: <span id="finalHearts">0</span></p>
        <button onclick="restartGame()">Play Again</button>
    </div>
</div>

<script>
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
const scoreElement = document.getElementById('score');
const heartsElement = document.getElementById('hearts');
const instructionsElement = document.getElementById('instructions');
const gameOverElement = document.getElementById('gameOver');

let gameState = 'waiting'; // waiting, playing, gameOver
let score = 0;
let hearts = 0;
let gameSpeed = 2;

// Game objects
const player = {
    x: canvas.width / 2 - 25,
    y: canvas.height - 80,
    width: 50,
    height: 30,
    color: '#0984e3'
};

const obstacles = [];
const collectibles = [];

// Input handling
let mouseX = player.x;
let mouseY = player.y;

canvas.addEventListener('mousemove', (e) => {
    const rect = canvas.getBoundingClientRect();
    mouseX = e.clientX - rect.left;
    mouseY = e.clientY - rect.top;
});

canvas.addEventListener('touchmove', (e) => {
    e.preventDefault();
    const rect = canvas.getBoundingClientRect();
    const touch = e.touches[0];
    mouseX = touch.clientX - rect.left;
    mouseY = touch.clientY - rect.top;
});

canvas.addEventListener('click', () => {
    if (gameState === 'waiting') {
        startGame();
    }
});

canvas.addEventListener('touchstart', (e) => {
    e.preventDefault();
    if (gameState === 'waiting') {
        startGame();
    }
});

function startGame() {
    gameState = 'playing';
    score = 0;
    hearts = 0;
    gameSpeed = 2;
    obstacles.length = 0;
    collectibles.length = 0;
    instructionsElement.style.display = 'none';
    gameOverElement.style.display = 'none';
    gameLoop();
}

function restartGame() {
    gameState = 'waiting';
    instructionsElement.style.display = 'block';
    gameOverElement.style.display = 'none';
}

function updatePlayer() {
    // Smooth movement towards mouse/touch position
    const targetX = mouseX - player.width / 2;
    const targetY = mouseY - player.height / 2;
    
    player.x += (targetX - player.x) * 0.1;
    player.y += (targetY - player.y) * 0.1;
    
    // Keep player within bounds
    player.x = Math.max(0, Math.min(canvas.width - player.width, player.x));
    player.y = Math.max(0, Math.min(canvas.height - player.height, player.y));
}

function spawnObstacle() {
    if (Math.random() < 0.02) {
        obstacles.push({
            x: Math.random() * (canvas.width - 30),
            y: -30,
            width: 30,
            height: 30,
            color: '#e17055'
        });
    }
}

function spawnCollectible() {
    if (Math.random() < 0.015) {
        collectibles.push({
            x: Math.random() * (canvas.width - 20),
            y: -20,
            width: 20,
            height: 20,
            color: '#e84393'
        });
    }
}

function updateObstacles() {
    for (let i = obstacles.length - 1; i >= 0; i--) {
        const obstacle = obstacles[i];
        obstacle.y += gameSpeed;
        
        // Remove obstacles that are off screen
        if (obstacle.y > canvas.height) {
            obstacles.splice(i, 1);
            score += 10; // Points for surviving
        }
        
        // Check collision with player
        else if (isColliding(player, obstacle)) {
            gameState = 'gameOver';
            showGameOver();
        }
    }
}

function updateCollectibles() {
    for (let i = collectibles.length - 1; i >= 0; i--) {
        const collectible = collectibles[i];
        collectible.y += gameSpeed;
        
        // Remove collectibles that are off screen
        if (collectible.y > canvas.height) {
            collectibles.splice(i, 1);
        }
        
        // Check collision with player
        else if (isColliding(player, collectible)) {
            collectibles.splice(i, 1);
            hearts++;
            score += 50;
        }
    }
}

function isColliding(rect1, rect2) {
    return rect1.x < rect2.x + rect2.width &&
           rect1.x + rect1.width > rect2.x &&
           rect1.y < rect2.y + rect2.height &&
           rect1.y + rect1.height > rect2.y;
}

function drawCar(x, y, width, height, color) {
    ctx.fillStyle = color;
    ctx.fillRect(x, y, width, height);
    
    // Car details
    ctx.fillStyle = '#74b9ff';
    ctx.fillRect(x + 5, y + 5, width - 10, height - 15);
    
    // Wheels
    ctx.fillStyle = '#2d3436';
    ctx.fillRect(x + 5, y + height - 8, 8, 6);
    ctx.fillRect(x + width - 13, y + height - 8, 8, 6);
}

function drawHeart(x, y, size) {
    ctx.fillStyle = '#e84393';
    ctx.font = `${size}px Arial`;
    ctx.textAlign = 'center';
    ctx.fillText('♥', x + size/2, y + size);
}

function drawObstacle(x, y, width, height, color) {
    ctx.fillStyle = color;
    ctx.fillRect(x, y, width, height);
    
    // Warning symbol
    ctx.fillStyle = 'white';
    ctx.font = '20px Arial';
    ctx.textAlign = 'center';
    ctx.fillText('!', x + width/2, y + height - 5);
}

function drawRoad() {
    // Road background
    ctx.fillStyle = '#2d3436';
    ctx.fillRect(0, 0, canvas.width, canvas.height);
    
    // Road lines
    ctx.fillStyle = '#fdcb6e';
    const lineHeight = 20;
    const lineSpacing = 40;
    const offset = (Date.now() * 0.1) % lineSpacing;
    
    for (let y = -offset; y < canvas.height; y += lineSpacing) {
        ctx.fillRect(canvas.width / 2 - 2, y, 4, lineHeight);
    }
}

function render() {
    // Clear canvas
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    
    // Draw road
    drawRoad();
    
    // Draw player car
    drawCar(player.x, player.y, player.width, player.height, player.color);
    
    // Draw obstacles
    obstacles.forEach(obstacle => {
        drawObstacle(obstacle.x, obstacle.y, obstacle.width, obstacle.height, obstacle.color);
    });
    
    // Draw collectibles
    collectibles.forEach(collectible => {
        drawHeart(collectible.x, collectible.y, collectible.width);
    });
    
    // Update UI
    scoreElement.textContent = score;
    heartsElement.textContent = hearts;
}

function showGameOver() {
    document.getElementById('finalScore').textContent = score;
    document.getElementById('finalHearts').textContent = hearts;
    gameOverElement.style.display = 'block';
}

function gameLoop() {
    if (gameState !== 'playing') return;
    
    updatePlayer();
    spawnObstacle();
    spawnCollectible();
    updateObstacles();
    updateCollectibles();
    
    // Increase game speed gradually
    gameSpeed += 0.001;
    
    render();
    requestAnimationFrame(gameLoop);
}

// Initial render
render();
</script>
</body>
</html>